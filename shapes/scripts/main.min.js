function countLevelAchievements(a){return a.filter(function(a){return a.match(/level/i)}).length}function showAchievement(){$("#notification").css({visibility:"visible"}),setTimeout(function(){$("#notification").css({visibility:"hidden"})},4e3)}function makeUnique(a){return a.filter(function(b,c){return a.indexOf(b)==c})}function addScoreAchievements(){for(var a=0;a<allScoreAchievements.length;a++){var b=allScoreAchievements[a];-1==scoreAchievements.indexOf(b.name)&&-1==oldAchievements.indexOf(b.name)&&totalScore>b.value&&(scoreAchievements.push(b.name),$("#notification").html(achievementMessage+"Score "+b.value),showAchievement())}}function addLevelAchievements(){var a="Level "+level;-1==levelAchievements.indexOf(a)&&-1==oldAchievements.indexOf(a)&&7>level&&(levelAchievements.push(a),$("#notification").html(achievementMessage+a),showAchievement())}function addAchievement(a){addLevelAchievements(),addScoreAchievements();var b=oldAchievements.concat(levelAchievements).concat(scoreAchievements);b=makeUnique(b),localStorage.shapesAchievements=JSON.stringify(b)}function randShape(){var a=Math.random();2>level?a>.5?generateCircle():generateRectangle():level>=2&&3>=level?randMed():level>=4&&5>=level?randHard():level>=6&&7>=level?randExtreme():randImpossible()}function randMed(){var a=Math.random();switch(!0){case a>.66:generateCircle();break;case a>.33&&.66>=a:generateRectangle();break;default:generateTriangle()}}function randHard(){var a=Math.random();switch(!0){case a>.75:generateCircle();break;case a>.5&&.75>=a:generateRectangle();break;case a>.25&&.5>=a:generateTriangle();break;default:generatePentagon()}}function randExtreme(){var a=Math.random();switch(!0){case a>.8:generateCircle();break;case a>.6&&.8>=a:generateRectangle();break;case a>.4&&.6>=a:generateTriangle();break;case a>.2&&.4>=a:generatePentagon();break;default:generateHexagon()}}function randImpossible(){var a=Math.random();switch(!0){case a>.83:generateCircle();break;case a>.67&&.83>=a:generateRectangle();break;case a>.5&&.67>=a:generateTriangle();break;case a>.33&&.5>=a:generatePentagon();break;case a>.17&&.33>=a:generateStar();break;default:generateHexagon()}}function displayScore(){var a=Number(localStorage.shapesCoins);displayLevel.innerHTML="<strong>Level: </strong>"+level+"<span id='score'>Score: "+score+"</span><span id='high-score'>High Score: "+highScore()+"</span><span id='coins'>Coins: <span class='coins-badge'>"+a+"</span></span"}function incrementScore(){score++,increaseTotalScore(),displayScore(),incrementLevel()}function increaseTotalScore(){var a=Number(localStorage.shapesTotalScore);localStorage.shapesTotalScore=++a}function incrementLevel(){level=Math.ceil(score/10),2==level&&$("#triangle").css({visibility:"visible"}),4==level&&$("#pentagon").css({visibility:"visible"}),6==level&&$("#hexagon").css({visibility:"visible"}),8==level&&$("#star").css({visibility:"visible"}),addAchievement(level),displayScore()}function highScore(){var a=JSON.parse(localStorage.shapeScores),b=Math.max.apply(Math,a);return Math.max(b,0)}function addScores(){var a=JSON.parse(localStorage.shapeScores);if(-1==scores.indexOf(score)&&scores.push(score),a.length>scores.length){var b=localStorage.shapeScores.replace("]",",")+score+"]";localStorage.shapeScores=b}else localStorage.shapeScores=JSON.stringify(scores)}function resetScore(){addScores(),addCoins(),score=0,displayScore()}function checkStorage(a){localStorage[a]||(localStorage[a]=JSON.stringify([]))}function createCanvas(){$("#canvas-block").append("<canvas></canvas>")}function readyCanvas(){canvas=$("canvas")[0],ctx=canvas.getContext("2d"),width=canvas.width,height=canvas.height}function randColor(){return colors[Math.floor(Math.random()*colors.length)]}function fillShape(a){ctx.fillStyle=randColor(),ctx.fill(),shapes[0]=a}function generateCircle(){ctx.beginPath(),ctx.arc(150,80,30,0,2*Math.PI),fillShape("circle")}function generateRectangle(){ctx.rect(100,50,100,60),fillShape("rectangle")}function generateTriangle(){ctx.beginPath(),ctx.moveTo(100,100),ctx.lineTo(150,50),ctx.lineTo(200,100),ctx.lineTo(100,100),fillShape("triangle"),ctx.closePath()}function generatePentagon(){ctx.beginPath(),ctx.moveTo(120,70),ctx.lineTo(150,30),ctx.lineTo(180,70),ctx.lineTo(180,110),ctx.lineTo(120,110),ctx.lineTo(120,70),fillShape("pentagon"),ctx.closePath()}function generateHexagon(){ctx.beginPath(),ctx.moveTo(100,80),ctx.lineTo(130,50),ctx.lineTo(160,50),ctx.lineTo(190,80),ctx.lineTo(160,110),ctx.lineTo(130,110),ctx.lineTo(100,80),fillShape("hexagon"),ctx.closePath()}function generateStar(){ctx.beginPath(),ctx.moveTo(150,60),ctx.lineTo(160,20),ctx.lineTo(170,60),ctx.lineTo(210,70),ctx.lineTo(170,80),ctx.lineTo(160,120),ctx.lineTo(150,80),ctx.lineTo(110,70),ctx.lineTo(150,60),fillShape("star"),ctx.closePath()}function rightAnswer(){incrementScore(),clearCanvas(),gameLoop()}function selectShape(a){shapes[0]==a?rightAnswer():gameOver()}function addCoins(){var a=Number(localStorage.shapesCoins),b=Math.floor(score/5);localStorage.shapesCoins=a>0?a+b:b,$("#coins-display .coins-badge").html(localStorage.shapesCoins)}function gameOver(){clearCanvas(),createCanvas(),readyCanvas(),endMessage(),resetScore(),playing=!1}function endMessage(){ctx.font="25px Arial";var a=ctx.createLinearGradient(80,50,200,0);a.addColorStop("0","magenta"),a.addColorStop("0.5","blue"),a.addColorStop("1.0","red"),ctx.fillStyle=a,ctx.fillText("Game Over",80,30),ctx.fillStyle="green",ctx.font="15px Arial",ctx.fillText("STATISTICS",80,70),ctx.fillStyle="black",ctx.fillText("You scored "+score+" points",80,90),ctx.fillText("You reached level "+level,80,110),ctx.fillText("You've earned "+Math.floor(score/5)+" coins",80,130)}function setTimer(){var a=score;setTimeout(function(){score==a&&gameOver()},levels[level])}function gameLoop(){createCanvas(),readyCanvas(),randShape(),setTimer()}function clearCanvas(){$("#canvas-block").empty()}function startGame(){$("#canvas-block").children.length>0&&clearCanvas(),playing=!0,localStorage.shapesGamesPlayed++,$("#circle, #rectangle").css({visibility:"visible"}),gameLoop(),displayScore()}function approvePurchase(){$("#purchase-notification").html("Your purchase has been confirmed"),$("#purchase-notification").css({visibility:"visible"}),setTimeout(function(){$("#purchase-notification").css({visibility:"hidden"})},5e3)}function rejectPurchase(){$("#purchase-notification").html("You don't have enough coins to make this purchase"),$("#purchase-notification").css({visibility:"visible",background:"red"}),setTimeout(function(){$("#purchase-notification").css({visibility:"hidden",background:"green"})},5e3)}$("#my-header").load("header.html"),$("#my-footer").load("footer.html"),setTimeout(function(){$("#coins-display .coins-badge").html(localStorage.shapesCoins)},100);var levelAchievements=[],scoreAchievements=[],gamesPlayed=Number(localStorage.shapesGamesPlayed),totalScore=Number(localStorage.shapesTotalScore),oldAchievements=JSON.parse(localStorage.shapesAchievements),achievementMessage="You have unlocked the achievement ",allScoreAchievements=[{name:"Score 100",value:100},{name:"Score 200",value:200},{name:"Score 500",value:500},{name:"Score 1000",value:1e3}];$(".level").each(function(){var a=$(this).html().match(/\d/)[0];$(this).parent().prop("class",a<=countLevelAchievements(oldAchievements)?"unlocked":"locked")}),$(".games-played").each(function(){var a=$(this).next().html().match(/\d+/)[0];$(this).parent().prop("class",gamesPlayed>=a?"unlocked":"locked")}),$(".total-score").each(function(){var a=$(this).next().html().match(/\d+/)[0];$(this).parent().prop("class",totalScore>=a?"unlocked":"locked")}),$("#my-header").load("header.html"),$("#my-footer").load("footer.html"),setTimeout(function(){$("#coins-display .coins-badge").html(localStorage.shapesCoins)},100);var displayLevel=document.getElementById("level"),score=0,scores=[],level=1,oldScores=JSON.parse(localStorage.shapeScores),sorted=oldScores.sort(function(a,b){return b-a}),levels={1:5e3,2:4500,3:4e3,4:3500,5:3e3,6:2500,7:2e3,8:1500,9:1e3,10:500};$("#scores-table tr:not(:first-child)").each(function(a){var b=sorted[a],c=Math.floor(b/10)+1;$(this).find("td:eq(1)").html(b||""),$(this).find("td:eq(2)").html(c||"")}),$("#my-header").load("header.html"),$("#my-footer").load("footer.html"),setTimeout(function(){$("#coins-display .coins-badge").html(localStorage.shapesCoins)},100);var shapes=[],playing=!1;checkStorage("shapesAchievements"),checkStorage("shapeScores"),checkStorage("shapePurchases"),localStorage.shapesGamesPlayed||(localStorage.shapesGamesPlayed=0),localStorage.shapesTotalScore||(localStorage.shapesTotalScore=0),localStorage.shapesCoins||(localStorage.shapesCoins=0);var colors=["red","orange","gold","green","blue","purple"],controls={67:"circle",82:"rectangle",84:"triangle",80:"pentagon",72:"hexagon",83:"star"};$(document).on("keydown",function(a){playing&&-1!=Object.keys(controls).indexOf(String(a.keyCode))&&(selectShape(controls[a.keyCode]),console.log("keycode"+controls[a.keyCode]))});for(var purchases=JSON.parse(localStorage.shapePurchases),cart=[],patterns=[{name:"Pattern 1",price:10},{name:"Pattern 2",price:10},{name:"Pattern 3",price:15},{name:"Pattern 4",price:15},{name:"Pattern 5",price:20},{name:"Pattern 6",price:20},{name:"Pattern 7",price:20}],i=0;i<patterns.length;i++)$("#shop-table tbody").append("<tr></tr>");$("#shop-table tbody tr").each(function(a){$(this).append("<td class='item'>"+patterns[a].name+"</td>"),$(this).append("<td>Image Placeholder</td>"),-1==purchases.indexOf(patterns[a].name)?$(this).append("<td><span class='coins-badge'>"+patterns[a].price+"</span></td>"):$(this).append("<td>Purchased</td>")}),$(".coins-badge").on("click",function(){var a=Number(localStorage.shapesCoins),b=Number($(this).html()),c=$(this);if(a>b){var d=c.closest("tr").find(".item").html();c.parent().html("Purchased"),localStorage.shapesCoins=a-b,$("#my-header .coins-badge").html(a-b),approvePurchase(),purchases.length?(cart.push(d),localStorage.shapePurchases=JSON.stringify(purchases.concat(cart))):-1==cart.indexOf(d)&&(cart.push(d),localStorage.shapePurchases=JSON.stringify(cart))}else rejectPurchase()});